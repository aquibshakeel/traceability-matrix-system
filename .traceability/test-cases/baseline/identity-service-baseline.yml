# Identity Service Test Cases Baseline
# QA-curated test scenarios for identity-service APIs

service: identity-service

# POST /identity/register
POST /identity/register:
#  happy_case:
#    - When user registers with valid email and password, return 201 with user ID
#    - When user registers with all optional fields, store complete profile
#  edge_case:
#    - When email contains special characters, accept and validate
#    - When password is exactly minimum length, accept registration
#  error_case:
#    - When email already exists, return 409 Conflict
#    - When password is too weak, return 400 with validation errors
#    - When email format is invalid, return 400
#  security:
#    - When password contains SQL injection, sanitize and store safely
#    - When XSS in name field, sanitize before storage

# POST /identity/login
POST /identity/login:
  happy_case:
    - When login with valid credentials, return 200 with JWT token
    - When login generates OTP, send to registered contact
    - When login with valid credentials, return success message and user details
  error_case:
    - When email doesn't exist, return 401 Unauthorized
    - When password is incorrect, return 401 Unauthorized
    - When account is locked, return 403 Forbidden
  security:
    - When multiple failed attempts, implement rate limiting
    - When login from new device, trigger additional verification

# POST /identity/verify-otp
POST /identity/verify-otp:
  happy_case:
    - When OTP is correct and not expired, verify successfully
    - When OTP verified, return auth token
  error_case:
    - When OTP is incorrect, return 401 Unauthorized
    - When OTP is expired, return 401 with expired message
    - When OTP attempts exceeded, lock verification
#  edge_case:
#    - When OTP is at expiry boundary, handle gracefully