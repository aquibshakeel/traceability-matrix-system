service: identity-service

business_journeys:
  - id: user-registration-flow
    name: "Complete User Registration Flow"
    description: "User registers → receives OTP → verifies account → gains access"
    priority: P0
    steps:
      - api: "POST /identity/register"
        description: "Create new user account"
        required: true
      - api: "POST /identity/verify-otp"
        description: "Verify user email with OTP"
        required: true
    e2e_tests:
      - file: "RegistrationFlowE2ETest.java"
        methods:
          - "testCompleteRegistrationFlow"
          - "testRegistrationWithInvalidOTP"
          - "testRegistrationWithExpiredOTP"
    tags: ["onboarding", "authentication", "security"]
    
  - id: user-login-flow
    name: "User Login Journey"
    description: "User logs in with credentials → receives JWT token"
    priority: P0
    steps:
      - api: "POST /identity/login"
        description: "Authenticate user credentials"
        required: true
    e2e_tests:
      - file: "LoginFlowE2ETest.java"
        methods:
          - "testSuccessfulLogin"
          - "testLoginWithInvalidCredentials"
          - "testLoginWithUnverifiedAccount"
    tags: ["authentication", "security"]
    
  - id: password-reset-flow
    name: "Password Reset Journey"
    description: "User requests password reset → receives OTP → sets new password"
    priority: P1
    steps:
      - api: "POST /identity/forgot-password"
        description: "Request password reset OTP"
        required: true
      - api: "POST /identity/verify-otp"
        description: "Verify OTP for password reset"
        required: true
      - api: "POST /identity/reset-password"
        description: "Set new password"
        required: true
    e2e_tests: []
    tags: ["account-recovery", "security"]

    # - id: token-refresh-flow.
