<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Developer Guide - Universal Unit-Test Traceability Validator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #1a202c;
            background: #f7fafc;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            background: white;
        }

        .sidebar {
            width: 280px;
            background: #2d3748;
            color: white;
            padding: 20px;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar h3 {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.1em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .sidebar ul {
            list-style: none;
        }

        .sidebar li {
            margin: 8px 0;
        }

        .sidebar a {
            color: #cbd5e0;
            text-decoration: none;
            display: block;
            padding: 8px 12px;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .sidebar a:hover {
            background: #4a5568;
            color: #fff;
            transform: translateX(5px);
        }

        .content {
            flex: 1;
            padding: 40px 60px;
            max-width: 900px;
        }

        .content h2 {
            color: #667eea;
            font-size: 2em;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .content h3 {
            color: #764ba2;
            font-size: 1.5em;
            margin: 30px 0 15px 0;
        }

        .content h4 {
            color: #667eea;
            font-size: 1.2em;
            margin: 20px 0 10px 0;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 5px 5px 5px 0;
        }

        .badge-p0 { background: #dc2626; color: white; }
        .badge-p1 { background: #f59e0b; color: white; }
        .badge-success { background: #10b981; color: white; }
        .badge-info { background: #3b82f6; color: white; }

        .code-block {
            background: #1a202c;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            text-align: left;
        }

        table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
        }

        table tr:hover {
            background: #f7fafc;
        }

        ul, ol {
            margin: 15px 0 15px 25px;
        }

        li {
            margin: 8px 0;
        }

        code {
            background: #edf2f7;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #d63384;
        }

        .toc {
            background: #f7fafc;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        @media print {
            .sidebar { display: none; }
            .content { max-width: 100%; padding: 20px; }
            .code-block { page-break-inside: avoid; }
        }

        @media (max-width: 1024px) {
            .container { flex-direction: column; }
            .sidebar { width: 100%; height: auto; position: relative; }
            .content { padding: 20px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üõ†Ô∏è Developer Guide</h1>
        <p>Universal Unit-Test Traceability Validator v2.0.0</p>
    </div>

    <div class="container">
        <nav class="sidebar">
            <h3>üìë Table of Contents</h3>
            <ul>
                <li><a href="#overview">1. System Overview</a></li>
                <li><a href="#quick-start">2. Quick Start</a></li>
                <li><a href="#integration">3. Integration Guide</a></li>
                <li><a href="#how-it-works">4. How It Works</a></li>
                <li><a href="#running">5. Running the Validator</a></li>
                <li><a href="#pre-commit">6. Pre-Commit Hook</a></li>
                <li><a href="#reports">7. Reading Reports</a></li>
                <li><a href="#fixing-orphans">8. Fixing Orphan Tests</a></li>
                <li><a href="#writing-tests">9. Writing Unit Tests</a></li>
                <li><a href="#troubleshooting">10. Troubleshooting</a></li>
                <li><a href="#acceptance">11. Acceptance Checklist</a></li>
            </ul>
        </nav>

        <main class="content">
            <section id="overview">
                <h2>1. System Overview üéØ</h2>
                
                <h3>What is it?</h3>
                <p>The <strong>Universal Unit-Test Traceability Validator</strong> is an intelligent framework that creates bidirectional mapping between business test scenarios and unit test implementations across multiple microservices.</p>

                <div class="info-box">
                    <strong>üí° Key Benefit:</strong> Know exactly which business requirements are covered by unit tests and which aren't.
                </div>

                <h3>Purpose</h3>
                <ul>
                    <li><strong>Visibility:</strong> Track test coverage for business scenarios</li>
                    <li><strong>Quality:</strong> Ensure critical features have test coverage</li>
                    <li><strong>Automation:</strong> Automatic validation on every commit</li>
                    <li><strong>Risk Management:</strong> Identify gaps in test coverage early</li>
                </ul>

                <h3>Core Capabilities</h3>
                <table>
                    <tr>
                        <th>Capability</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>üîç Service Discovery</td>
                        <td>Automatically detects all microservices</td>
                    </tr>
                    <tr>
                        <td>üìä Dynamic Test Parsing</td>
                        <td>Supports Java, TypeScript, Python, Go</td>
                    </tr>
                    <tr>
                        <td>üß† Smart Matching</td>
                        <td>7 advanced strategies (Exact, Fuzzy, Semantic, etc.)</td>
                    </tr>
                    <tr>
                        <td>üìà Gap Analysis</td>
                        <td>P0/P1/P2/P3 priority-based gap identification</td>
                    </tr>
                    <tr>
                        <td>üîß Orphan Detection</td>
                        <td>Finds tests without scenarios (with suggested fixes)</td>
                    </tr>
                    <tr>
                        <td>üö® API Discovery</td>
                        <td>Detects orphan APIs (no scenarios AND no tests)</td>
                    </tr>
                    <tr>
                        <td>üé® Rich Reports</td>
                        <td>HTML/JSON/Markdown/CSV formats</td>
                    </tr>
                    <tr>
                        <td>üîÑ Pre-Commit</td>
                        <td>Automatic validation on every commit</td>
                    </tr>
                </table>
            </section>

            <section id="quick-start">
                <h2>2. Quick Start (5 Minutes) ‚ö°</h2>

                <h3>Prerequisites</h3>
                <ul>
                    <li>Node.js >= 14.x</li>
                    <li>npm or yarn</li>
                    <li>Git</li>
                </ul>

                <h3>Installation</h3>
                <div class="code-block">
# Clone or navigate to your project
cd /path/to/your/project

# Install dependencies
npm install

# Install pre-commit hooks
npm run install-hooks
                </div>

                <h3>First Run</h3>
                <div class="code-block">
# Validate all services
npm run validate

# Validate specific service
npm run validate -- --service customer-service

# Open the HTML report (auto-opens after validation)
# Report location: .traceability/reports/traceability-report.html
                </div>

                <div class="success-box">
                    <strong>‚úÖ Success!</strong> The HTML report will automatically open in your browser showing coverage, gaps, and orphan tests.
                </div>
            </section>

            <section id="integration">
                <h2>3. Service Integration Guide üîå</h2>

                <h3>Step 1: Add Service Configuration</h3>
                <p>Edit <code>.traceability/config.json</code>:</p>
                <div class="code-block">
{
  "services": [
    {
      "name": "your-service",
      "enabled": true,
      "path": "services/your-service",
      "language": "java",
      "testFramework": "junit",
      "testDirectory": "src/test/java",
      "testPattern": "**/*Test.java",
      "scenarioFile": ".traceability/scenarios/your-service.scenarios.yaml"
    }
  ]
}
                </div>

                <h3>Step 2: Create Scenario File</h3>
                <p>Create <code>.traceability/scenarios/your-service.scenarios.yaml</code>:</p>
                <div class="code-block">
scenarios:
  - id: YOUR-001
    description: User can create new order
    priority: P0
    riskLevel: Critical
    apiEndpoint: /api/orders
    httpMethod: POST
    acceptanceCriteria:
      - Valid order payload creates order
      - Returns 201 status code
      - Returns order ID in response
                </div>

                <h3>Step 3: Run Validation</h3>
                <div class="code-block">
npm run validate -- --service your-service
                </div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Important:</strong> No code changes required! The validator reads your existing tests.
                </div>
            </section>

            <section id="how-it-works">
                <h2>4. How the Validator Works üß†</h2>

                <h3>6-Phase Process</h3>
                <ol>
                    <li><strong>Service Discovery:</strong> Scans filesystem for services</li>
                    <li><strong>Test Parsing:</strong> Extracts unit tests from code</li>
                    <li><strong>Scenario Loading:</strong> Loads business scenarios from YAML/JSON</li>
                    <li><strong>Semantic Matching:</strong> Maps scenarios to tests using 7 strategies</li>
                    <li><strong>Gap Analysis:</strong> Identifies coverage gaps and orphans</li>
                    <li><strong>Report Generation:</strong> Creates HTML/JSON/Markdown/CSV reports</li>
                </ol>

                <h3>7 Matching Strategies</h3>
                <table>
                    <tr>
                        <th>Strategy</th>
                        <th>Weight</th>
                        <th>Example</th>
                    </tr>
                    <tr>
                        <td>Exact Matching</td>
                        <td>2.0</td>
                        <td><code>/api/users</code> = <code>/api/users</code></td>
                    </tr>
                    <tr>
                        <td>Fuzzy Matching</td>
                        <td>1.5</td>
                        <td>"create user" ‚âà "creating users"</td>
                    </tr>
                    <tr>
                        <td>Semantic</td>
                        <td>1.2</td>
                        <td>"create" = "add" = "insert"</td>
                    </tr>
                    <tr>
                        <td>Keyword</td>
                        <td>1.0</td>
                        <td>POST, 404, customer, etc.</td>
                    </tr>
                    <tr>
                        <td>Levenshtein</td>
                        <td>-</td>
                        <td>Edit distance for typos</td>
                    </tr>
                    <tr>
                        <td>Jaccard</td>
                        <td>-</td>
                        <td>Set-based word similarity</td>
                    </tr>
                    <tr>
                        <td>Regex</td>
                        <td>-</td>
                        <td>Pattern matching</td>
                    </tr>
                </table>

                <h3>Coverage Calculation</h3>
                <div class="code-block">
finalScore = (exact √ó 2.0) + (fuzzy √ó 1.5) + (semantic √ó 1.2) + (keyword √ó 1.0)
confidence = (finalScore / maxPossibleScore) √ó 100

if confidence >= 75% ‚Üí "Fully Covered" ‚úÖ
if confidence >= 60% ‚Üí "Partially Covered" ‚ö†Ô∏è
if confidence < 60%  ‚Üí "Not Covered" ‚ùå
                </div>
            </section>

            <section id="running">
                <h2>5. Running the Validator üöÄ</h2>

                <h3>Normal Run</h3>
                <div class="code-block">
# Validate all services
npm run validate

# Validate specific service
npm run validate -- --service customer-service

# Validate only changed services (based on git diff)
npm run validate -- --changed
                </div>

                <h3>Dry Run (No Pre-Commit Enforcement)</h3>
                <div class="code-block">
# Run without blocking commits
npm run validate -- --dry-run
                </div>

                <h3>Output</h3>
                <ul>
                    <li><strong>HTML Report:</strong> <code>.traceability/reports/traceability-report.html</code> (auto-opens)</li>
                    <li><strong>JSON Report:</strong> <code>.traceability/reports/traceability-report.json</code></li>
                    <li><strong>Markdown:</strong> <code>.traceability/reports/traceability-report.md</code></li>
                    <li><strong>CSV:</strong> <code>.traceability/reports/traceability-report.csv</code></li>
                </ul>
            </section>

            <section id="pre-commit">
                <h2>6. Pre-Commit Hook Integration üîÑ</h2>

                <h3>How It Works</h3>
                <p>The pre-commit hook automatically runs on every <code>git commit</code> and:</p>
                <ol>
                    <li>Runs secrets scanning (Gitleaks)</li>
                    <li>Runs traceability validation</li>
                    <li>Blocks commit if P0 gaps exist</li>
                    <li>Allows commit if only P1/P2/P3 gaps</li>
                </ol>

                <h3>Opt-In (Default)</h3>
                <div class="code-block">
# Install hooks
npm run install-hooks

# Now every commit runs validation
git commit -m "Add feature"
                </div>

                <h3>Opt-Out (For Local Development)</h3>
                <div class="code-block">
# Skip validation for this commit
git commit --no-verify -m "WIP: Feature in progress"

# Or uninstall hooks
rm .git/hooks/pre-commit
                </div>

                <div class="info-box">
                    <strong>üí° Best Practice:</strong> Use <code>--no-verify</code> for WIP commits, but ensure validation passes before pushing.
                </div>

                <h3>Blocking Behavior</h3>
                <table>
                    <tr>
                        <th>Priority</th>
                        <th>Behavior</th>
                        <th>Config Key</th>
                    </tr>
                    <tr>
                        <td><span class="badge badge-p0">P0</span></td>
                        <td>BLOCKS commits</td>
                        <td><code>blockOnP0Gaps: true</code></td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-p1">P1</span></td>
                        <td>Warning only</td>
                        <td><code>blockOnP1Gaps: false</code></td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-info">P2/P3</span></td>
                        <td>Informational</td>
                        <td>N/A</td>
                    </tr>
                </table>
            </section>

            <section id="reports">
                <h2>7. Interpreting Reports üìä</h2>

                <h3>Report Sections</h3>
                <ul>
                    <li><strong>Coverage Overview:</strong> Overall % and scenario breakdown</li>
                    <li><strong>Coverage Gaps:</strong> Scenarios without tests (with recommendations)</li>
                    <li><strong>Orphan APIs:</strong> APIs discovered without scenarios/tests</li>
                    <li><strong>Orphan Tests:</strong> Tests without scenarios (with suggested fixes)</li>
                    <li><strong>Traceability Matrix:</strong> Scenario-to-test mapping</li>
                    <li><strong>Visual Analytics:</strong> Charts showing coverage trends</li>
                </ul>

                <h3>Suggested Fixes Column (NEW)</h3>
                <p>The orphan tests table now includes a "Suggested Fix" column:</p>
                <table>
                    <tr>
                        <th>Test Category</th>
                        <th>Suggested Fix</th>
                    </tr>
                    <tr>
                        <td>üíº Business Logic</td>
                        <td><span style="color: #dc2626;">QA Action: Create scenario for this Controller/API Test</span><br>Suggested ID: CUST-XXX</td>
                    </tr>
                    <tr>
                        <td>üîß Technical</td>
                        <td><span style="color: #6b7280;">No action needed</span> - Infrastructure test</td>
                    </tr>
                </table>

                <div class="success-box">
                    <strong>‚úÖ Auto-Open Feature:</strong> Reports automatically open in your browser after validation!
                </div>
            </section>

            <section id="fixing-orphans">
                <h2>8. Fixing Orphan Test Recommendations üîß</h2>

                <h3>What is an Orphan Test?</h3>
                <p>A unit test that exists but isn't mapped to any business scenario.</p>

                <h3>Types of Orphans</h3>
                <ol>
                    <li><strong>Business Logic Tests (15 found)</strong> - QA action required</li>
                    <li><strong>Technical Tests (29 found)</strong> - No action needed</li>
                </ol>

                <h3>Example: Fixing a Business Logic Orphan</h3>
                
                <h4>Step 1: Identify the Orphan</h4>
                <div class="code-block">
Test: CustomerControllerTest.getCustomers_ShouldReturnAllCustomers
Suggested Fix: QA Action - Create scenario
Suggested ID: CUST-XXX
                </div>

                <h4>Step 2: Create Scenario</h4>
                <p>Add to <code>.traceability/scenarios/customer-service.scenarios.yaml</code>:</p>
                <div class="code-block">
- id: CUST-015
  description: Retrieve all customers without filters
  priority: P1
  riskLevel: Medium
  apiEndpoint: /api/customers
  httpMethod: GET
  acceptanceCriteria:
    - Returns list of all customers
    - Returns 200 status code
    - Response includes customer details
                </div>

                <h4>Step 3: Re-Run Validation</h4>
                <div class="code-block">
npm run validate -- --service customer-service
                </div>

                <div class="success-box">
                    <strong>‚úÖ Result:</strong> The test is now mapped to CUST-015 and no longer orphaned!
                </div>
            </section>

            <section id="writing-tests">
                <h2>9. Writing Unit Tests (Best Practices) ‚úçÔ∏è</h2>

                <h3>AAA Pattern</h3>
                <p>Follow the <strong>Arrange-Act-Assert</strong> pattern:</p>
                <div class="code-block">
@Test
public void testCreateCustomer_Success() {
    // Arrange
    CustomerRequest request = new CustomerRequest("John", "Doe", 30);
    
    // Act
    CustomerResponse response = service.createCustomer(request);
    
    // Assert
    assertNotNull(response.getId());
    assertEquals("John", response.getFirstName());
}
                </div>

                <h3>Naming Convention</h3>
                <p>Use descriptive names that match scenario descriptions:</p>
                <div class="code-block">
// Good - Matches scenario description
@Test
public void createCustomer_ShouldReturnSuccess_WhenValidPayload() { }

// Bad - Too generic
@Test
public void test1() { }
                </div>

                <h3>Coverage Requirements</h3>
                <table>
                    <tr>
                        <th>Layer</th>
                        <th>What to Test</th>
                        <th>Priority</th>
                    </tr>
                    <tr>
                        <td>Controller</td>
                        <td>API endpoints, validation, status codes</td>
                        <td><span class="badge badge-p0">P0</span></td>
                    </tr>
                    <tr>
                        <td>Service</td>
                        <td>Business logic, error handling</td>
                        <td><span class="badge badge-p1">P1</span></td>
                    </tr>
                    <tr>
                        <td>Repository</td>
                        <td>Data persistence, queries</td>
                        <td><span class="badge badge-info">P2</span></td>
                    </tr>
                    <tr>
                        <td>DTO/Mapper</td>
                        <td>Data transformation</td>
                        <td><span class="badge badge-info">P3</span></td>
                    </tr>
                </table>
            </section>

            <section id="troubleshooting">
                <h2>10. Troubleshooting üîç</h2>

                <h3>Common Errors</h3>

                <h4>Error: "Config file not found"</h4>
                <div class="code-block">
Solution: Ensure you're running from project root where .traceability/config.json exists
cd /path/to/project-root
npm run validate
                </div>

                <h4>Error: "No tests found"</h4>
                <div class="code-block">
Solution: Check testPattern in config.json matches your test files
For Java: "**/*Test.java" or "**/*Tests.java"
For TypeScript: "**/*.test.ts" or "**/*.spec.ts"
                </div>

                <h4>Issue: Low Match Scores</h4>
                <div class="code-block">
Solution: Ensure test descriptions contain relevant keywords
- Include API endpoint in test name
- Use domain terms from scenario description
- Reference scenario ID in test comments
                </div>

                <h4>Issue: Too Many Orphan Tests</h4>
                <div class="code-block">
Solution:
1. Create scenarios for business logic tests (Controller/Service tests)
2. Technical tests (DTOs, Mappers) can remain as orphans
3. Use suggested IDs from the report
                </div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Need Help?</strong> Check <code>docs/QA_GUIDE.md</code> or contact the QA Automation Team.
                </div>
            </section>

            <section id="acceptance">
                <h2>11. Integration Acceptance Checklist ‚úÖ</h2>

                <h3>Phase 1: Configuration</h3>
                <ul>
                    <li>‚òê Service added to <code>.traceability/config.json</code></li>
                    <li>‚òê Scenario file created at correct path</li>
                    <li>‚òê Test patterns match actual test files</li>
                </ul>

                <h3>Phase 2: Initial Run</h3>
                <ul>
                    <li>‚òê <code>npm run validate</code> executes successfully</li>
                    <li>‚òê HTML report generates and opens</li>
                    <li>‚òê Service appears in report with correct test count</li>
                </ul>

                <h3>Phase 3: Scenario Coverage</h3>
                <ul>
                    <li>‚òê All P0 scenarios have test coverage</li>
                    <li>‚òê P1 scenarios 80%+ covered</li>
                    <li>‚òê Business logic orphans have scenarios created</li>
                </ul>

                <h3>Phase 4: Pre-Commit Integration</h3>
                <ul>
                    <li>‚òê Pre-commit hook installed (<code>npm run install-hooks</code>)</li>
                    <li>‚òê Test commit - validation runs automatically</li>
                    <li>‚òê P0 gaps correctly block commits</li>
                </ul>

                <h3>Phase 5: Team Onboarding</h3>
                <ul>
                    <li>‚òê Team trained on reading reports</li>
                    <li>‚òê Process documented for adding new scenarios</li>
                    <li>‚òê QA/Dev handoff process established</li>
                </ul>

                <h3>Phase 6: Ongoing Maintenance</h3>
                <ul>
                    <li>‚òê Weekly review of orphan tests</li>
                    <li>‚òê Monthly coverage trend analysis</li>
                    <li>‚òê Quarterly configuration review</li>
                </ul>

                <div class="success-box">
                    <strong>üéâ Congratulations!</strong> Service integration complete when all checkboxes are checked!
                </div>
            </section>

            <footer style="margin-top: 60px; padding-top: 30px; border-top: 2px solid #e2e8f0; text-align: center; color: #718096;">
                <p>Universal Unit-Test Traceability Validator v2.0.0 | Developer Guide</p>
                <p>Generated: December 2025 | For more info, see <code>docs/QA_GUIDE.html</code></p>
            </footer>
        </main>
    </div>
</body>
</html>
